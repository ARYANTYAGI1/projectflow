import{b as L,c as k,u as w,e as U,f as I}from"./device-b98782a2.js";import{a as B}from"./vuex-235c7b47.js";import{_ as T}from"./index-b0184b1b.js";import{an as l,au as E,o as m,c as p,a as _,M as P,C as e,y as s,l as h,F as j,L as G,s as b,D as y,E as F}from"./@vue-7664832f.js";import"./js-cookie-edb2da2a.js";import"./vue-router-627d3bcd.js";import"./axios-dd1c8fc2.js";import"./element-plus-97d68548.js";import"./lodash-es-2e98bc53.js";import"./@element-plus-7759aa15.js";import"./@popperjs-d53b9d70.js";import"./@ctrl-f8748455.js";import"./dayjs-de1d8cda.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-10c90328.js";import"./vue-i18n-f00e7388.js";import"./@intlify-ddb89f4e.js";import"./simplebar-vue-88307be6.js";import"./simplebar-core-cc63b2ef.js";import"./metismenujs-584191f1.js";import"./bootstrap-vue-next-01df5512.js";import"./maska-1eacf752.js";import"./moment-aaecb89a.js";const M={page:{title:"Create Device",meta:[{name:"description"}]},data(){return{addingRequest:!1,detailLoading:!1,id:"",isEdit:!1,usersList:[],deviceForm:{deviceName:"",deviceCode:"",description:"",user:""},rules:{deviceName:[{required:!0,message:this.$t("company.deviceNameIsRequired"),trigger:"change"}],deviceCode:[{required:!0,message:this.$t("company.deviceCodeIsRequired"),trigger:"change"}],description:[{required:!0,message:this.$t("company.descriptionIsRequired"),trigger:"change"}],user:[{required:!0,message:this.$t("company.userIsRequired"),trigger:"change"}]}}},created(){this.getPageInfo()},computed:{...B(["userType","userid"])},methods:{async getPageInfo(){this.detailLoading=!0;const o=await L();this.usersList=o.data.data;const i=this.$route.params.id;if(this.id=i,i){let c=await k(i);this.deviceForm=c.data.data}this.detailLoading=!1},sumbitForm(o){this.$refs[o].validate(i=>{if(i){const{deviceCode:c,deviceName:f,description:t,user:g,_id:d}=this.deviceForm,n={deviceCode:c,deviceName:f,description:t,user:this.userType=="2"?this.userid:g};d?(this.addingRequest=!0,w(d,n).then(a=>{this.addingRequest=!1,this.$message({type:"success",message:a.data.message}),U(d).then(()=>{this.$router.push({path:"/device"})}).catch(u=>{this.$message.error("Failed to update measurements: "+u.message)})}).catch(a=>{this.addingRequest=!1,this.$message.error(a.message)})):(this.addingRequest=!0,I(n).then(a=>{this.addingRequest=!1,this.$router.push({path:"/device"}),this.$refs[o].resetFields(),this.$message({type:"success",message:a.data.message})}).catch(a=>{this.addingRequest=!1,this.$message.error(a.message)}))}else return console.log("error submit!!"),!1})}}},S={class:"profile-page mt-3"},z={class:"container-fluid"},A={class:"d-flex align-items-center justify-content-center mt-4"},H={key:0};function J(o,i,c,f,t,g){const d=l("el-input"),n=l("el-form-item"),a=l("el-col"),u=l("el-row"),q=l("el-option"),V=l("el-select"),v=l("el-button"),C=l("router-link"),N=l("el-form"),$=l("el-card"),R=E("loading");return m(),p("div",null,[_("section",S,[P((m(),p("div",z,[e($,null,{default:s(()=>[e(N,{ref:"deviceForm",model:t.deviceForm,rules:t.rules,"label-width":"auto","label-position":"top"},{default:s(()=>[e(u,{gutter:20},{default:s(()=>[e(a,{md:12},{default:s(()=>[e(n,{label:o.$t("user.deviceCode"),prop:"deviceCode"},{default:s(()=>[e(d,{modelValue:t.deviceForm.deviceCode,"onUpdate:modelValue":i[0]||(i[0]=r=>t.deviceForm.deviceCode=r),disabled:!!t.id,type:"text",placeholder:o.$t("user.deviceCode")},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),_:1}),e(a,{md:12},{default:s(()=>[e(n,{label:o.$t("user.deviceName"),prop:"deviceName"},{default:s(()=>[e(d,{modelValue:t.deviceForm.deviceName,"onUpdate:modelValue":i[1]||(i[1]=r=>t.deviceForm.deviceName=r),type:"text",placeholder:o.$t("user.deviceName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),o.userType!=2?(m(),h(u,{key:0,gutter:20},{default:s(()=>[e(a,{md:12},{default:s(()=>[e(n,{label:o.$t("company.user"),prop:"user"},{default:s(()=>[e(V,{modelValue:t.deviceForm.user,"onUpdate:modelValue":i[2]||(i[2]=r=>t.deviceForm.user=r),class:"w100",placeholder:o.$t("company.selectUser"),clearable:"",filterable:"",remote:""},{default:s(()=>[(m(!0),p(j,null,G(t.usersList,(r,D)=>(m(),h(q,{key:D,label:`${r.email} | ${r.fullName?r.fullName:""}`,value:r._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})):b("",!0),e(u,{gutter:20},{default:s(()=>[e(a,{md:24},{default:s(()=>[e(n,{label:o.$t("company.description")},{default:s(()=>[e(d,{type:"textarea",modelValue:t.deviceForm.description,"onUpdate:modelValue":i[3]||(i[3]=r=>t.deviceForm.description=r),rows:5},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),_("div",A,[e(v,{class:"btn btn-primary",disabled:t.addingRequest,onClick:i[4]||(i[4]=r=>g.sumbitForm("deviceForm"))},{default:s(()=>[y(F(o.$t("company.save")),1),t.addingRequest?(m(),p("span",H," ...")):b("",!0)]),_:1},8,["disabled"]),e(C,{to:"/device"},{default:s(()=>[e(v,{class:"btn btn-secondary ms-3"},{default:s(()=>[y(F(o.$t("company.cancel")),1)]),_:1})]),_:1})])]),_:1},8,["model","rules"])]),_:1})])),[[R,t.detailLoading]])])])}const _e=T(M,[["render",J]]);export{_e as default};
