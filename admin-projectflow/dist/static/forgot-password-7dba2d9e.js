import{_ as F,f as b,r as C}from"./index-b0184b1b.js";import{v as k}from"./user-c789e581.js";import{an as l,o as u,c,a as e,C as o,y as r,E as f,D as d,s as g}from"./@vue-7664832f.js";import"./vuex-235c7b47.js";import"./js-cookie-edb2da2a.js";import"./vue-router-627d3bcd.js";import"./axios-dd1c8fc2.js";import"./element-plus-97d68548.js";import"./lodash-es-2e98bc53.js";import"./@element-plus-7759aa15.js";import"./@popperjs-d53b9d70.js";import"./@ctrl-f8748455.js";import"./dayjs-de1d8cda.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-10c90328.js";import"./vue-i18n-f00e7388.js";import"./@intlify-ddb89f4e.js";import"./simplebar-vue-88307be6.js";import"./simplebar-core-cc63b2ef.js";import"./metismenujs-584191f1.js";import"./bootstrap-vue-next-01df5512.js";import"./maska-1eacf752.js";import"./moment-aaecb89a.js";const V={data(){return{email:"",otp:"",submitted:!1,error:null,tryingToReset:!1,verifyCodeMode:!1,resetPasswordMode:!1,forgotPasswordMode:!0,passwordForm:{newPassword:"",confirmPassword:""},userData:{},loading:!1,emailForm:{email:""},otpForm:{otp:""},emailRules:{email:[{required:!0,message:this.$t("company.emailIsRequired"),trigger:"change"}]},otpRules:{otp:[{required:!0,message:this.$t("company.otpIsRequired"),trigger:"change"}]},passwordRules:{newPassword:[{required:!0,message:this.$t("user.pleaseEnterNewPassword"),trigger:"change"}],confirmPassword:[{required:!0,message:this.$t("user.pleaseEnterConfirmPassword"),trigger:"change"}]}}},created(){this.$route.query&&this.$route.query.id&&this.$route.query.token&&(this.forgotPasswordMode=!1,this.resetPasswordMode=!0),document.body.classList.add("auth-body-bg")},methods:{forgotPassword(){this.$refs.emailForm.validate(a=>{if(a)this.loading=!0,b({email:this.emailForm.email}).then(s=>{this.loading=!1,this.$message({message:s.data.message,type:"success"}),this.forgotPasswordMode=!1,this.verifyCodeMode=!0}).catch(s=>{this.$message({message:s.message,type:"error"}),this.loading=!1});else return!1})},verifyOTP(){this.$refs.otpForm.validate(a=>{if(a)this.loading=!0,k({code:this.otpForm.otp}).then(s=>{this.loading=!1,this.userData=s.data.data,this.$message({message:s.data.message,type:"success"}),this.verifyCodeMode=!1,this.resetPasswordMode=!0}).catch(s=>{this.$message({message:s.message,type:"error"}),this.loading=!1});else return!1})},requestResetPassword(){this.$refs.passwordForm.validate(a=>{if(a){if(this.passwordForm.newPassword&&this.passwordForm.confirmPassword){var s={userId:this.userData.userId,token:this.userData.token,newPassword:this.passwordForm.newPassword,confirmPassword:this.passwordForm.confirmPassword};this.loading=!0,C(s).then(m=>{this.loading=!1,this.forgotPasswordMode=!1,this.resetPasswordMode=!1,this.$router.push({path:"/login"}),this.$message({message:m.data.message,type:"success"})}).catch(m=>{this.$message({message:m.message,type:"error"}),this.loading=!1})}}else return!1})}}},M={class:"container-fluid p-0"},x={class:"authentication-page-content p-4 d-flex align-items-center min-vh-100"},R={class:"w-100"},q={class:"d-flex justify-content-center"},D={style:{width:"100%","max-width":"500px"}},N={class:"card",style:{"border-width":"0"}},T={class:"mb-3 login-card"},$=e("h1",{style:{color:"white"}},"ProjectFlow",-1),E={class:"p-5 pb-4 pt-2"},I={key:0},U={class:"font-size-18 mt-2"},B={class:"mt-4 text-center"},O={class:"mt-3 text-center"},S={key:1},z={class:"font-size-18 mt-2"},L={class:"text-muted"},j={class:"mt-4 text-center"},A={key:2},G={class:"text-muted"},H={class:"text-center"};function J(a,s,m,K,t,h){const y=l("router-link"),n=l("el-input"),p=l("el-form-item"),w=l("el-button"),_=l("el-form"),P=l("el-col"),v=l("el-row");return u(),c("div",null,[e("div",M,[e("div",null,[e("div",null,[e("div",x,[e("div",R,[e("div",q,[e("div",D,[e("div",null,[e("div",N,[e("div",null,[e("div",T,[o(y,{to:"/",class:"logo"},{default:r(()=>[$]),_:1})])]),e("div",E,[t.forgotPasswordMode?(u(),c("div",I,[e("h4",U,f(a.$t("company.resetPassword")),1),o(_,{ref:"emailForm",model:t.emailForm,rules:t.emailRules},{default:r(()=>[o(p,{prop:"email"},{default:r(()=>[o(n,{modelValue:t.emailForm.email,"onUpdate:modelValue":s[0]||(s[0]=i=>t.emailForm.email=i),type:"email",id:"email",placeholder:"Email"},null,8,["modelValue"])]),_:1}),e("div",B,[o(w,{class:"btn btn-primary w-md waves-effect waves-light",type:"primary",onClick:h.forgotPassword},{default:r(()=>[d("Reset")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"]),e("div",O,[e("p",null,[d(" Torna al login "),o(y,{tag:"a",to:"/login",class:"font-weight-medium text-primary"},{default:r(()=>[d("Log in")]),_:1})])])])):g("",!0),t.verifyCodeMode?(u(),c("div",S,[e("h4",z,f(a.$t("company.resetPassword")),1),e("p",L,f(a.$t("company.optMessage")),1),o(_,{model:t.otpForm,rules:t.otpRules,ref:"otpForm"},{default:r(()=>[o(p,{prop:"otp"},{default:r(()=>[o(n,{modelValue:t.otpForm.otp,"onUpdate:modelValue":s[1]||(s[1]=i=>t.otpForm.otp=i),id:"otp",placeholder:"OTP"},null,8,["modelValue"])]),_:1}),e("div",j,[o(w,{class:"btn btn-primary w-md waves-effect waves-light",type:"primary",onClick:h.verifyOTP},{default:r(()=>[d("Submit")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])])):g("",!0),t.resetPasswordMode?(u(),c("div",A,[e("p",G,f(a.$t("company.enterPassword")),1),o(_,{model:t.passwordForm,rules:t.passwordRules,ref:"passwordForm"},{default:r(()=>[o(v,{gutter:20},{default:r(()=>[o(P,{md:24},{default:r(()=>[o(p,{prop:"newPassword"},{default:r(()=>[o(n,{type:"password",modelValue:t.passwordForm.newPassword,"onUpdate:modelValue":s[2]||(s[2]=i=>t.passwordForm.newPassword=i),placeholder:"Nuova Password"},null,8,["modelValue"])]),_:1})]),_:1}),o(P,{md:24},{default:r(()=>[o(p,{prop:"confirmPassword"},{default:r(()=>[o(n,{type:"password",modelValue:t.passwordForm.confirmPassword,"onUpdate:modelValue":s[3]||(s[3]=i=>t.passwordForm.confirmPassword=i),placeholder:"Conferma Password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e("div",H,[o(w,{class:"btn btn-primary",onClick:h.requestResetPassword},{default:r(()=>[d("Submit")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])])):g("",!0)])])])])])])])])])])])}const Pe=F(V,[["render",J]]);export{Pe as default};
