import{g as v,d as Q}from"./measurement-a22da7db.js";import{a as L}from"./vuex-235c7b47.js";import{h as $}from"./moment-aaecb89a.js";import{an as o,au as P,o as g,c as b,a as i,C as a,y as s,D as m,E as r,M as y,l as B,s as U,N as E}from"./@vue-7664832f.js";import{_ as S}from"./index-b0184b1b.js";import"./js-cookie-edb2da2a.js";import"./vue-router-627d3bcd.js";import"./axios-dd1c8fc2.js";import"./element-plus-97d68548.js";import"./lodash-es-2e98bc53.js";import"./@element-plus-7759aa15.js";import"./@popperjs-d53b9d70.js";import"./@ctrl-f8748455.js";import"./dayjs-de1d8cda.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-10c90328.js";import"./vue-i18n-f00e7388.js";import"./@intlify-ddb89f4e.js";import"./simplebar-vue-88307be6.js";import"./simplebar-core-cc63b2ef.js";import"./metismenujs-584191f1.js";import"./bootstrap-vue-next-01df5512.js";import"./maska-1eacf752.js";const Y={data(){return{listLoading:!1,listQuery:{page:1,limit:10,name:""},measurementList:[],total:0,measurementModel:!1,selectedMeasurement:{}}},computed:{...L(["userType"]),totalPages(){return Math.ceil(this.total/this.listQuery.limit)}},created(){this.getPageInfo()},methods:{async getPageInfo(){this.listLoading=!0;try{const e=await v(this.listQuery);this.measurementList=e.data.data,this.total=e.data.totalCount}catch(e){console.error("Error fetching measurement list:",e)}finally{this.listLoading=!1}},async handleFilter(){this.listLoading=!0;try{const e=await v(this.listQuery);this.measurementList=e.data.data,this.total=e.data.totalCount}catch(e){console.error("Error filtering measurement list:",e)}finally{this.listLoading=!1}},async handlePageChange(e){this.listQuery.page=e,await this.handleFilter()},deleteUser(e){this.$confirm(this.$t("company.confirmToMeasurement"),this.$t("company.warning"),{confirmButtonText:this.$t("company.confirm"),cancelButtonText:this.$t("company.cancel"),type:"warning"}).then(async()=>{try{const n=await Q(e);this.$message.success({message:n.data.message}),this.getPageInfo()}catch(n){this.$message.error(n.message)}}).catch(n=>{console.log(n)})},formatDateTime(e){return e?$(String(e)).format("DD/MM/YYYY HH:mm"):null},async viewDevice(e){this.selectedMeasurement=e,this.measurementModel=!0}}},F={class:"filter-container"},I={class:"d-flex justify-content-between mb-3"},j={class:"w-100 me-2"},z={class:"d-flex"},H={class:"user-table"},K={class:"d-flex justify-content-center"},A={class:"pe-2"},G=i("i",{class:"mdi mdi-eye"},null,-1),q=i("i",{class:"mdi mdi-account-edit"},null,-1),x=i("i",{class:"mdi mdi-delete"},null,-1),J={class:"page-pagination"},O={class:"pagination-container"},R={class:"pagination-text"},W={class:"text-center"},X=i("i",{class:"el-icon-circle-check"},null,-1);function Z(e,n,ee,te,l,c){const w=o("el-input"),d=o("el-button"),h=o("router-link"),u=o("el-table-column"),M=o("el-table"),C=o("el-pagination"),D=o("el-card"),_=o("el-form-item"),p=o("el-col"),f=o("el-row"),N=o("el-form"),k=o("el-dialog"),T=P("loading");return g(),b("div",F,[i("section",null,[a(D,{class:"full-height-card"},{default:s(()=>[i("div",I,[i("div",j,[a(w,{modelValue:l.listQuery.name,"onUpdate:modelValue":n[0]||(n[0]=t=>l.listQuery.name=t),placeholder:e.$t("company.searchByDeviceNameDeviceCode"),onKeyup:c.handleFilter},null,8,["modelValue","placeholder","onKeyup"])]),i("div",z,[a(h,{to:"/measurement/create"},{default:s(()=>[a(d,{class:"btn btn-primary me-2 w-100"},{default:s(()=>[m(r(e.$t("user.addMeasurements")),1)]),_:1})]),_:1})])]),y((g(),b("div",H,[a(M,{data:l.measurementList,border:"",style:{width:"100%"}},{default:s(()=>[a(u,{align:"center",label:e.$t("user.device")},{default:s(t=>[m(r(t.row.device?t.row.device.deviceCode?t.row.device.deviceName?`${t.row.device.deviceCode} | ${t.row.device.deviceName}`:`${t.row.device.deviceCode} | --`:t.row.device.deviceName?`-- | ${t.row.device.deviceName}`:"--":"--"),1)]),_:1},8,["label"]),a(u,{align:"center",label:e.$t("user.dateTime"),width:"180"},{default:s(t=>[m(r(c.formatDateTime(t.row.measureDateTime)),1)]),_:1},8,["label"]),a(u,{align:"center",label:e.$t("user.temperature"),width:"180"},{default:s(t=>[m(r(`${t.row.measure} °${t.row.scale}`),1)]),_:1},8,["label"]),e.userType=="1"?(g(),B(u,{key:0,align:"center",label:e.$t("user.user"),width:"210"},{default:s(t=>[m(r(t.row.user&&t.row.user.email&&t.row.user.fullName?`${t.row.user.email} |
                ${t.row.user.fullName}`:"--"),1)]),_:1},8,["label"])):U("",!0),a(u,{align:"center",label:e.$t("table.actions"),width:"180"},{default:s(({row:t})=>[i("div",K,[i("div",A,[a(d,{class:"btn btn-primary table-icon-btn",onClick:V=>c.viewDevice(t)},{default:s(()=>[G]),_:2},1032,["onClick"])]),a(h,{to:`/measurement/create/${t._id}`,class:"pe-2"},{default:s(()=>[a(d,{class:"btn btn-primary table-icon-btn"},{default:s(()=>[q]),_:1})]),_:2},1032,["to"]),a(d,{class:"btn btn-primary delete-btn table-icon-btn",onClick:V=>c.deleteUser(`${t._id}`)},{default:s(()=>[x]),_:2},1032,["onClick"])])]),_:1},8,["label"])]),_:1},8,["data"]),y(i("div",J,[i("div",O,[a(C,{background:"",modelValue:l.listQuery.page,"onUpdate:modelValue":n[1]||(n[1]=t=>l.listQuery.page=t),"page-size":l.listQuery.limit,total:l.total,layout:"prev, pager, next",onCurrentChange:c.handlePageChange},null,8,["modelValue","page-size","total","onCurrentChange"]),i("span",R,r(e.$t("Settings.packageAgent.paginationText",{page:l.listQuery.page,totalPages:c.totalPages,total:l.total})),1)])],512),[[E,l.total>l.listQuery.limit]])])),[[T,l.listLoading]])]),_:1})]),a(k,{class:"custom-dialog form-item-label",title:e.$t("company.measurementDetails"),modelValue:l.measurementModel,"onUpdate:modelValue":n[3]||(n[3]=t=>l.measurementModel=t)},{default:s(()=>[a(N,{"label-position":"top"},{default:s(()=>[i("div",null,[a(f,{gutter:20},{default:s(()=>[a(p,{class:"field",span:12},{default:s(()=>[a(_,{label:e.$t("user.device")},{default:s(()=>[m(r(l.selectedMeasurement.device?l.selectedMeasurement.device.deviceCode?`${l.selectedMeasurement.device.deviceCode} | ${l.selectedMeasurement.device.deviceName}`:`-- |
                ${l.selectedMeasurement.device.deviceName}`:"--"),1)]),_:1},8,["label"])]),_:1}),a(p,{span:12},{default:s(()=>[a(_,{label:e.$t("user.temperature")},{default:s(()=>[m(r(`${l.selectedMeasurement.measure} °${l.selectedMeasurement.scale}`),1)]),_:1},8,["label"])]),_:1})]),_:1}),a(f,{gutter:20},{default:s(()=>[a(p,{span:12},{default:s(()=>[a(_,{label:e.$t("user.dateTime")},{default:s(()=>[m(r(c.formatDateTime(l.selectedMeasurement.measureDateTime)),1)]),_:1},8,["label"])]),_:1})]),_:1}),a(f,{gutter:20},{default:s(()=>[a(p,{span:12},{default:s(()=>[a(_,{label:e.$t("user.user")},{default:s(()=>[m(r(l.selectedMeasurement.user&&l.selectedMeasurement.user.email&&l.selectedMeasurement.user.fullName?`${l.selectedMeasurement.user.email} | ${l.selectedMeasurement.user.fullName}`:"--"),1)]),_:1},8,["label"])]),_:1})]),_:1})]),i("div",W,[a(d,{class:"btn btn-primary",onClick:n[2]||(n[2]=t=>l.measurementModel=!1)},{default:s(()=>[X,m(" "+r(e.$t("company.done")),1)]),_:1})])]),_:1})]),_:1},8,["title","modelValue"])])}const Te=S(Y,[["render",Z]]);export{Te as default};
