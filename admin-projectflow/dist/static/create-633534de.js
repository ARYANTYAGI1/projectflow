import{a as F,b as U,c as I,u as M,e as N}from"./measurement-a22da7db.js";import{a as B}from"./vuex-235c7b47.js";import{_ as O}from"./index-b0184b1b.js";import{an as o,au as Y,o as u,c as p,a as k,M as E,C as s,y as r,l as _,F as v,L as b,s as q,D as V,E as C}from"./@vue-7664832f.js";import"./js-cookie-edb2da2a.js";import"./vue-router-627d3bcd.js";import"./axios-dd1c8fc2.js";import"./element-plus-97d68548.js";import"./lodash-es-2e98bc53.js";import"./@element-plus-7759aa15.js";import"./@popperjs-d53b9d70.js";import"./@ctrl-f8748455.js";import"./dayjs-de1d8cda.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-10c90328.js";import"./vue-i18n-f00e7388.js";import"./@intlify-ddb89f4e.js";import"./simplebar-vue-88307be6.js";import"./simplebar-core-cc63b2ef.js";import"./metismenujs-584191f1.js";import"./bootstrap-vue-next-01df5512.js";import"./maska-1eacf752.js";import"./moment-aaecb89a.js";function H(){return[{key:"C",value:"°C | Celsius"},{key:"F",value:"°F | Fahrenheit"}]}const P={page:{title:"Create Measurement",meta:[{name:"description"}]},data(){return{addingRequest:!1,detailLoading:!1,id:"",isEdit:!1,deviceList:[],userList:[],ruleForm:{device:"",measure:0,measureDateTime:"",scale:"C",user:""},marks:{"-100":"-100",0:"0",100:"100"},scaleOptions:[],rules:{device:[{required:!0,message:this.$t("company.deviceIsRequired"),trigger:"change"}],measure:[{required:!0,message:this.$t("company.measureIsRequired"),trigger:"change"}],measureDateTime:[{required:!0,message:this.$t("company.dateIsRequired"),trigger:"change"}],scale:[{required:!0,message:this.$t("company.scaleIsRequired"),trigger:"change"}],user:[{required:!0,message:this.$t("company.userIsRequired"),trigger:"change"}]}}},created(){this.getPageInfo()},computed:{...B(["userType","userid"])},methods:{async getPageInfo(){this.detailLoading=!0;const a=await F();this.deviceList=a.data.data,this.scaleOptions=H();const l=await U();this.userList=l.data.data;const n=this.$route.params.id;if(this.id=n,n){let g=await I(n);this.ruleForm=g.data.data,this.userType==1&&this.ruleForm.user&&await this.handleUserChange(this.ruleForm.user)}this.id||(this.ruleForm.measureDateTime=new Date),this.detailLoading=!1},async handleUserChange(a){if(this.userType==1&&a){const l=await F({userId:a});this.deviceList=l.data.data}},sumbitForm(a){this.$refs[a].validate(l=>{if(l){const{device:n,scale:g,user:t,measure:h,measureDateTime:c,_id:d}=this.ruleForm,m={device:n,scale:g,user:t,measure:h,measureDateTime:c,user:this.userType=="2"?this.userid:t};d?(this.addingRequest=!0,M(d,m).then(i=>{this.addingRequest=!1,this.$message({type:"success",message:i.data.message}),this.$router.push({path:"/measurements"})}).catch(i=>{this.addingRequest=!1,this.$message.error(i.message)})):(this.addingRequest=!0,N(m).then(i=>{this.addingRequest=!1,this.$router.push({path:"/measurements"}),this.$refs[a].resetFields(),this.$message({type:"success",message:i.data.message})}).catch(i=>{this.addingRequest=!1,this.$message.error(i.message)}))}else return console.log("error submit!!"),!1})}}},S={class:"profile-page mt-3"},j={class:"container-fluid"},G={class:"d-flex align-items-center justify-content-center mt-4"},z={key:0};function A(a,l,n,g,t,h){const c=o("el-option"),d=o("el-select"),m=o("el-form-item"),i=o("el-col"),f=o("el-row"),D=o("el-date-picker"),T=o("el-slider"),y=o("el-button"),L=o("router-link"),R=o("el-form"),w=o("el-card"),$=Y("loading");return u(),p("div",null,[k("section",S,[E((u(),p("div",j,[s(w,null,{default:r(()=>[s(R,{ref:"ruleForm",model:t.ruleForm,rules:t.rules,"label-width":"auto","label-position":"top"},{default:r(()=>[a.userType!=2?(u(),_(f,{key:0,gutter:20},{default:r(()=>[s(i,{md:24},{default:r(()=>[s(m,{label:a.$t("user.user"),prop:"user"},{default:r(()=>[s(d,{modelValue:t.ruleForm.user,"onUpdate:modelValue":l[0]||(l[0]=e=>t.ruleForm.user=e),placeholder:a.$t("user.user"),disabled:!!t.id,onChange:h.handleUserChange},{default:r(()=>[(u(!0),p(v,null,b(t.userList,e=>(u(),_(c,{key:e.value,label:`${e.email} | ${e.fullName?e.fullName:"--"}`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","disabled","onChange"])]),_:1},8,["label"])]),_:1})]),_:1})):q("",!0),s(f,{gutter:20},{default:r(()=>[s(i,{md:24},{default:r(()=>[s(m,{label:a.$t("user.device"),prop:"device"},{default:r(()=>[s(d,{modelValue:t.ruleForm.device,"onUpdate:modelValue":l[1]||(l[1]=e=>t.ruleForm.device=e),placeholder:a.$t("user.device"),disabled:a.userType==1&&!t.ruleForm.user},{default:r(()=>[(u(!0),p(v,null,b(t.deviceList,e=>(u(),_(c,{key:e.value,label:`${e.deviceName} | ${e.deviceCode}`,value:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label"])]),_:1})]),_:1}),s(f,{gutter:20},{default:r(()=>[s(i,{md:12},{default:r(()=>[s(m,{label:a.$t("user.dateTime"),prop:"measureDateTime"},{default:r(()=>[s(D,{modelValue:t.ruleForm.measureDateTime,"onUpdate:modelValue":l[2]||(l[2]=e=>t.ruleForm.measureDateTime=e),format:"DD/MM/YYYY HH:mm",type:"datetime",placeholder:a.$t("user.dateTime"),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(i,{md:12},{default:r(()=>[s(m,{label:a.$t("user.scale"),prop:"scale"},{default:r(()=>[s(d,{modelValue:t.ruleForm.scale,"onUpdate:modelValue":l[3]||(l[3]=e=>t.ruleForm.scale=e),placeholder:a.$t("user.scale")},{default:r(()=>[(u(!0),p(v,null,b(t.scaleOptions,e=>(u(),_(c,{key:e.key,label:e.value,value:e.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),s(f,{gutter:20},{default:r(()=>[s(i,{md:24},{default:r(()=>[s(m,{label:a.$t("user.temperature"),prop:"measure"},{default:r(()=>[s(T,{modelValue:t.ruleForm.measure,"onUpdate:modelValue":l[4]||(l[4]=e=>t.ruleForm.measure=e),min:-100,max:100,marks:t.marks},null,8,["modelValue","marks"])]),_:1},8,["label"])]),_:1})]),_:1}),k("div",G,[s(y,{class:"btn btn-primary",disabled:t.addingRequest,onClick:l[5]||(l[5]=e=>h.sumbitForm("ruleForm"))},{default:r(()=>[V(C(a.$t("company.save")),1),t.addingRequest?(u(),p("span",z," ...")):q("",!0)]),_:1},8,["disabled"]),s(L,{to:"/measurements"},{default:r(()=>[s(y,{class:"btn btn-secondary ms-3"},{default:r(()=>[V(C(a.$t("company.cancel")),1)]),_:1})]),_:1})])]),_:1},8,["model","rules"])]),_:1})])),[[$,t.detailLoading]])])])}const ve=O(P,[["render",A]]);export{ve as default};
