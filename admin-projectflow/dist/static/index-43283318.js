import{g as b,a as P,d as B}from"./device-b98782a2.js";import{a as M}from"./vuex-235c7b47.js";import{an as n,au as T,o as h,c as w,a as s,C as t,y as l,D as c,E as r,M as D,l as E,s as F,N as U}from"./@vue-7664832f.js";import{_ as A}from"./index-b0184b1b.js";import"./js-cookie-edb2da2a.js";import"./vue-router-627d3bcd.js";import"./axios-dd1c8fc2.js";import"./element-plus-97d68548.js";import"./lodash-es-2e98bc53.js";import"./@element-plus-7759aa15.js";import"./@popperjs-d53b9d70.js";import"./@ctrl-f8748455.js";import"./dayjs-de1d8cda.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-10c90328.js";import"./vue-i18n-f00e7388.js";import"./@intlify-ddb89f4e.js";import"./simplebar-vue-88307be6.js";import"./simplebar-core-cc63b2ef.js";import"./metismenujs-584191f1.js";import"./bootstrap-vue-next-01df5512.js";import"./maska-1eacf752.js";import"./moment-aaecb89a.js";const S={data(){return{listLoading:!1,listQuery:{page:1,limit:10,name:""},deviceList:[],total:0,deviceModel:!1,selectedDevice:{},fridgeList:{}}},computed:{...M(["userType"]),totalPages(){return Math.ceil(this.total/this.listQuery.limit)}},created(){this.getPageInfo()},methods:{async getPageInfo(){this.listLoading=!0;try{const e=await b(this.listQuery),o=await P(),v=Array.isArray(o.data.data.data)?o.data.data.data:o.data.data.data.titleIt||[],a=e.data.data.map(d=>{const _=v.find(m=>m.ProjectFlowCode===d.deviceCode);return{...d,fridgeInfo:_}});this.deviceList=a,this.total=e.data.totalCount}catch(e){console.error("Error fetching device list:",e)}finally{this.listLoading=!1}},async handleFilter(){this.listLoading=!0;try{const e=await b(this.listQuery);this.deviceList=e.data.data,this.total=e.data.totalCount}catch(e){console.error("Error filtering device list:",e)}finally{this.listLoading=!1}},async handlePageChange(e){this.listQuery.page=e,await this.handleFilter()},deleteUser(e){this.$confirm(this.$t("company.confirmTodevice"),this.$t("company.warning"),{confirmButtonText:this.$t("company.confirm"),cancelButtonText:this.$t("company.cancel"),type:"warning"}).then(async()=>{try{const o=await B(e);this.$message.success({message:o.data.message}),this.getPageInfo()}catch(o){this.$message.error(o.message)}}).catch(o=>{console.log(o)})},formatDate(e){return this.$filters.formatDate(e)},async viewDevice(e){this.listLoading=!0,this.selectedDevice=e,this.deviceModel=!0,this.listLoading=!1}}},j={class:"filter-container"},z={class:"d-flex justify-content-between mb-3"},K={class:"w-100 me-2"},G={class:"d-flex"},R={class:"user-table"},q={class:"d-flex justify-content-center"},H={class:"pe-2"},J=s("i",{class:"mdi mdi-eye"},null,-1),O=s("i",{class:"mdi mdi-account-edit"},null,-1),W=s("i",{class:"mdi mdi-delete"},null,-1),X={class:"page-pagination"},Y={class:"pagination-container"},Z={class:"pagination-text"},x={class:"text-center"},ee=s("i",{class:"el-icon-circle-check"},null,-1);function te(e,o,v,C,a,d){const _=n("el-input"),m=n("el-button"),y=n("router-link"),u=n("el-table-column"),L=n("el-table"),N=n("el-pagination"),k=n("el-card"),p=n("el-form-item"),f=n("el-col"),g=n("el-row"),V=n("el-form"),Q=n("el-dialog"),I=T("loading");return h(),w("div",j,[s("section",null,[t(k,{class:"full-height-card"},{default:l(()=>[s("div",z,[s("div",K,[t(_,{modelValue:a.listQuery.name,"onUpdate:modelValue":o[0]||(o[0]=i=>a.listQuery.name=i),placeholder:e.$t("company.searchByEmailDeviceName"),onKeyup:d.handleFilter},null,8,["modelValue","placeholder","onKeyup"])]),s("div",G,[t(y,{to:"/device/create"},{default:l(()=>[t(m,{class:"btn btn-primary me-2 w-100"},{default:l(()=>[c(r(e.$t("table.addDevices")),1)]),_:1})]),_:1})])]),D((h(),w("div",R,[t(L,{data:a.deviceList,border:"",style:{width:"100%"}},{default:l(()=>[t(u,{align:"center",label:e.$t("company.deviceCode"),width:"180"},{default:l(i=>[c(r(i.row.deviceCode),1)]),_:1},8,["label"]),t(u,{align:"center",label:e.$t("company.deviceName"),width:"150"},{default:l(i=>[c(r(i.row.deviceName?i.row.deviceName:"--"),1)]),_:1},8,["label"]),t(u,{align:"center",label:e.$t("company.fridgeName"),width:"150"},{default:l(i=>[c(r(i.row.fridgeInfo&&i.row.fridgeInfo.titleIt?i.row.fridgeInfo.titleIt:"--"),1)]),_:1},8,["label"]),t(u,{align:"center",label:e.$t("table.description")},{default:l(i=>[c(r(i.row.description?`${i.row.description}`:"--"),1)]),_:1},8,["label"]),e.userType=="1"?(h(),E(u,{key:0,align:"center",label:e.$t("company.user"),width:"200"},{default:l(i=>[c(r(i.row.user?i.row.user.fullName?`${i.row.user.fullName} | ${i.row.user.email}`:`-- | ${i.row.user.email}`:"--"),1)]),_:1},8,["label"])):F("",!0),t(u,{align:"center",label:e.$t("table.actions"),width:"180"},{default:l(({row:i})=>[s("div",q,[s("div",H,[t(m,{class:"btn btn-primary table-icon-btn",onClick:$=>d.viewDevice(i)},{default:l(()=>[J]),_:2},1032,["onClick"])]),t(y,{to:`/device/create/${i._id}`,class:"pe-2"},{default:l(()=>[t(m,{class:"btn btn-primary table-icon-btn"},{default:l(()=>[O]),_:1})]),_:2},1032,["to"]),t(m,{class:"btn btn-primary delete-btn table-icon-btn",onClick:$=>d.deleteUser(`${i._id}`)},{default:l(()=>[W]),_:2},1032,["onClick"])])]),_:1},8,["label"])]),_:1},8,["data"]),D(s("div",X,[s("div",Y,[t(N,{background:"",modelValue:a.listQuery.page,"onUpdate:modelValue":o[1]||(o[1]=i=>a.listQuery.page=i),"page-size":a.listQuery.limit,total:a.total,layout:"prev, pager, next",onCurrentChange:d.handlePageChange},null,8,["modelValue","page-size","total","onCurrentChange"]),s("span",Z,r(e.$t("Settings.packageAgent.paginationText",{page:a.listQuery.page,totalPages:d.totalPages,total:a.total})),1)])],512),[[U,a.total>a.listQuery.limit]])])),[[I,a.listLoading]])]),_:1})]),t(Q,{class:"custom-dialog form-item-label",title:e.$t("company.deviceDetail"),modelValue:a.deviceModel,"onUpdate:modelValue":o[3]||(o[3]=i=>a.deviceModel=i)},{default:l(()=>[t(V,{"label-position":"top"},{default:l(()=>[s("div",null,[t(g,{gutter:20},{default:l(()=>[t(f,{class:"field",span:12},{default:l(()=>[t(p,{label:e.$t("company.deviceName")},{default:l(()=>[c(r(a.selectedDevice.deviceName?a.selectedDevice.deviceName:"--"),1)]),_:1},8,["label"])]),_:1}),t(f,{span:12},{default:l(()=>[t(p,{label:e.$t("company.deviceCode")},{default:l(()=>[c(r(a.selectedDevice.deviceCode),1)]),_:1},8,["label"])]),_:1})]),_:1}),t(g,{gutter:20},{default:l(()=>[t(f,{span:24},{default:l(()=>[t(p,{label:e.$t("company.description")},{default:l(()=>[c(r(a.selectedDevice.description?a.selectedDevice.description:"--"),1)]),_:1},8,["label"])]),_:1})]),_:1}),t(g,{gutter:20},{default:l(()=>[t(f,{span:12},{default:l(()=>[t(p,{label:e.$t("company.user")},{default:l(()=>[c(r(a.selectedDevice.user?a.selectedDevice.user.fullName?`${a.selectedDevice.user.fullName} | ${a.selectedDevice.user.email}`:`-- | ${a.selectedDevice.user.email}`:"--"),1)]),_:1},8,["label"])]),_:1})]),_:1})]),s("div",x,[t(m,{class:"btn btn-primary",onClick:o[2]||(o[2]=i=>a.deviceModel=!1)},{default:l(()=>[ee,c(" "+r(e.$t("company.done")),1)]),_:1})])]),_:1})]),_:1},8,["title","modelValue"])])}const Ve=A(S,[["render",te]]);export{Ve as default};
